{% extends "base.html" %}

{% block title %}–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ - Telegram Mini App{% endblock %}

{% block extra_css %}
    <!-- Chart.js –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <!-- –°—Ç–∏–ª–∏ –¥–ª—è –≤–∫–ª–∞–¥–æ–∫ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/analytics-tabs.css') }}">
{% endblock %}

{% block content %}
<div class="container">
    <!-- Hero Section -->
    <div class="hero-section animate-fade-in">
        <button class="back-btn" onclick="goBack()">‚Üê –ù–∞–∑–∞–¥</button>
        <div class="hero-content">
            <span class="hero-icon">üìä</span>
            <h1 class="hero-title">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</h1>
            <p class="hero-subtitle">–î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–∞—à–∏—Ö –∫–∞–Ω–∞–ª–æ–≤ –∏ –æ—Ñ—Ñ–µ—Ä–æ–≤</p>
        </div>
    </div>

    <!-- Stats Grid -->
    <div class="stats-grid">
        <div class="stat-card animate-fade-in animate-delay-100">
            <div class="stat-icon">üëÅÔ∏è</div>
            <div class="stat-number" id="total-views">
                <span class="loading-skeleton">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
            </div>
            <div class="stat-label">–í—Å–µ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤</div>
        </div>

        <div class="stat-card animate-fade-in animate-delay-200">
            <div class="stat-icon">üëÜ</div>
            <div class="stat-number" id="click-rate">
                <span class="loading-skeleton">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
            </div>
            <div class="stat-label">CTR</div>
        </div>

        <div class="stat-card animate-fade-in animate-delay-300">
            <div class="stat-icon">üí∞</div>
            <div class="stat-number" id="total-revenue">
                <span class="loading-skeleton">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
            </div>
            <div class="stat-label">–î–æ—Ö–æ–¥</div>
        </div>

        <div class="stat-card animate-fade-in animate-delay-400">
            <div class="stat-icon">üìà</div>
            <div class="stat-number" id="conversion-rate">
                <span class="loading-skeleton">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
            </div>
            <div class="stat-label">–ö–æ–Ω–≤–µ—Ä—Å–∏—è</div>
        </div>
    </div>

    <!-- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–∞–±—ã -->
    <div class="tabs">
        <nav class="tabs-nav">
            <li><a href="#" class="active" data-tab="overview">–û–±–∑–æ—Ä</a></li>
            <li><a href="#" data-tab="channels">–ü–æ –∫–∞–Ω–∞–ª–∞–º</a></li>
            <li><a href="#" data-tab="offers">–ü–æ –æ—Ñ—Ñ–µ—Ä–∞–º</a></li>
            <li><a href="#" data-tab="revenue">–î–æ—Ö–æ–¥—ã</a></li>
        </nav>
    </div>

    <!-- Tab: –û–±–∑–æ—Ä -->
    <div class="tabs-content active" id="overview">
        <!-- Charts Container -->
        <div class="stats-grid">
            <div class="card animate-slide-in animate-delay-100">
                <div class="card-header">
                    <h3 class="card-title">–î–∏–Ω–∞–º–∏–∫–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤</h3>
                    <p class="card-subtitle">–ó–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π</p>
                </div>
                <div class="card-body">
                    <div class="chart-container" style="height: 300px;">
                        <canvas id="viewsChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="card animate-slide-in animate-delay-200">
                <div class="card-header">
                    <h3 class="card-title">–°—Ç–∞—Ç—É—Å—ã –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π</h3>
                    <p class="card-subtitle">–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–∫–ª–∏–∫–æ–≤</p>
                </div>
                <div class="card-body">
                    <div class="chart-container" style="height: 300px;">
                        <canvas id="proposalsChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="card animate-slide-in animate-delay-300">
                <div class="card-header">
                    <h3 class="card-title">–†–∞—Å—Ö–æ–¥—ã –ø–æ –¥–Ω—è–º</h3>
                    <p class="card-subtitle">–î–∏–Ω–∞–º–∏–∫–∞ —Ç—Ä–∞—Ç</p>
                </div>
                <div class="card-body">
                    <div class="chart-container" style="height: 300px;">
                        <canvas id="spendingChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="card animate-slide-in animate-delay-400">
                <div class="card-header">
                    <h3 class="card-title">–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</h3>
                    <p class="card-subtitle">–ö–ª—é—á–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏</p>
                </div>
                <div class="card-body">
                    <div class="chart-container" style="height: 300px;">
                        <canvas id="efficiencyChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab: –ü–æ –∫–∞–Ω–∞–ª–∞–º -->
    <div class="tabs-content" id="channels">
        <!-- –°–≤–æ–¥–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∫–∞–Ω–∞–ª–æ–≤ -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">üì∫</div>
                <div class="stat-number" id="channels-total-count">
                    <span class="loading-skeleton">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                </div>
                <div class="stat-label">–í—Å–µ–≥–æ –∫–∞–Ω–∞–ª–æ–≤</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">‚úÖ</div>
                <div class="stat-number" id="channels-verified-count">
                    <span class="loading-skeleton">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                </div>
                <div class="stat-label">–í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üë•</div>
                <div class="stat-number" id="channels-total-subscribers">
                    <span class="loading-skeleton">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                </div>
                <div class="stat-label">–û–±—â–∏–π –æ—Ö–≤–∞—Ç</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üí∞</div>
                <div class="stat-number" id="channels-total-earned">
                    <span class="loading-skeleton">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                </div>
                <div class="stat-label">–û–±—â–∏–π –¥–æ—Ö–æ–¥</div>
            </div>
        </div>

        <!-- –¢–∞–±–ª–∏—Ü–∞ –∫–∞–Ω–∞–ª–æ–≤ -->
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">üìä –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–∞–Ω–∞–ª–æ–≤</h3>
                <p class="card-subtitle">–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫–∞–∂–¥–æ–≥–æ –∫–∞–Ω–∞–ª–∞</p>
            </div>
            <div class="card-body">
                <div id="channels-loading" class="loading-state">
                    <div class="loading-spinner"></div>
                    <p>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤...</p>
                </div>
                <div id="channels-error" class="error-state" style="display: none;">
                    <div class="error-icon">‚ùå</div>
                    <p>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤</p>
                    <button onclick="loadChannelsData()" class="btn-retry">–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞</button>
                </div>
                <div id="channels-content" style="display: none;">
                    <div class="table-container">
                        <table class="analytics-table">
                            <thead>
                                <tr>
                                    <th>–ö–∞–Ω–∞–ª</th>
                                    <th>–ü–æ–¥–ø–∏—Å—á–∏–∫–∏</th>
                                    <th>–°—Ç–∞—Ç—É—Å</th>
                                    <th>–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</th>
                                    <th>–ü—Ä–∏–Ω—è—Ç–æ</th>
                                    <th>CTR</th>
                                    <th>–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ</th>
                                </tr>
                            </thead>
                            <tbody id="channels-table-body">
                                <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                            </tbody>
                        </table>
                    </div>
                    <div id="channels-empty" class="empty-state" style="display: none;">
                        <div class="stat-icon">üì∫</div>
                        <h3>–ù–µ—Ç –∫–∞–Ω–∞–ª–æ–≤</h3>
                        <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.</p>
                        <a href="/channels" class="btn-primary">–î–æ–±–∞–≤–∏—Ç—å –∫–∞–Ω–∞–ª</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab: –ü–æ –æ—Ñ—Ñ–µ—Ä–∞–º -->
    <div class="tabs-content" id="offers">
        <!-- –°–≤–æ–¥–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –æ—Ñ—Ñ–µ—Ä–æ–≤ -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">üì¢</div>
                <div class="stat-number" id="offers-total-count">
                    <span class="loading-skeleton">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                </div>
                <div class="stat-label">–í—Å–µ–≥–æ –æ—Ñ—Ñ–µ—Ä–æ–≤</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üü¢</div>
                <div class="stat-number" id="offers-active-count">
                    <span class="loading-skeleton">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                </div>
                <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üí∏</div>
                <div class="stat-number" id="offers-total-spent">
                    <span class="loading-skeleton">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                </div>
                <div class="stat-label">–û–±—â–∏–µ —Ä–∞—Å—Ö–æ–¥—ã</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üìà</div>
                <div class="stat-number" id="offers-avg-ctr">
                    <span class="loading-skeleton">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                </div>
                <div class="stat-label">–°—Ä–µ–¥–Ω–∏–π CTR</div>
            </div>
        </div>

        <!-- –¢–∞–±–ª–∏—Ü–∞ –æ—Ñ—Ñ–µ—Ä–æ–≤ -->
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">üìä –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ñ—Ñ–µ—Ä–æ–≤</h3>
                <p class="card-subtitle">–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π</p>
            </div>
            <div class="card-body">
                <div id="offers-loading" class="loading-state">
                    <div class="loading-spinner"></div>
                    <p>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ—Ñ—Ñ–µ—Ä–æ–≤...</p>
                </div>
                <div id="offers-error" class="error-state" style="display: none;">
                    <div class="error-icon">‚ùå</div>
                    <p>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –æ—Ñ—Ñ–µ—Ä–æ–≤</p>
                    <button onclick="loadOffersData()" class="btn-retry">–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞</button>
                </div>
                <div id="offers-content" style="display: none;">
                    <div class="table-container">
                        <table class="analytics-table">
                            <thead>
                                <tr>
                                    <th>–û—Ñ—Ñ–µ—Ä</th>
                                    <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                                    <th>–¶–µ–Ω–∞</th>
                                    <th>–°—Ç–∞—Ç—É—Å</th>
                                    <th>–û—Ç–∫–ª–∏–∫–∏</th>
                                    <th>CTR</th>
                                    <th>ROI</th>
                                    <th>–ü–æ—Ç—Ä–∞—á–µ–Ω–æ</th>
                                </tr>
                            </thead>
                            <tbody id="offers-table-body">
                                <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                            </tbody>
                        </table>
                    </div>
                    <div id="offers-empty" class="empty-state" style="display: none;">
                        <div class="stat-icon">üì¢</div>
                        <h3>–ù–µ—Ç –æ—Ñ—Ñ–µ—Ä–æ–≤</h3>
                        <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –æ—Ñ—Ñ–µ—Ä–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.</p>
                        <a href="/create-offer" class="btn-primary">–°–æ–∑–¥–∞—Ç—å –æ—Ñ—Ñ–µ—Ä</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab: –î–æ—Ö–æ–¥—ã -->
    <div class="tabs-content" id="revenue">
        <!-- –°–≤–æ–¥–Ω—ã–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">üí∞</div>
                <div class="stat-number" id="revenue-current-balance">
                    <span class="loading-skeleton">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                </div>
                <div class="stat-label">–¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üìà</div>
                <div class="stat-number" id="revenue-total-earned">
                    <span class="loading-skeleton">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                </div>
                <div class="stat-label">–í—Å–µ–≥–æ –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–æ</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üìâ</div>
                <div class="stat-number" id="revenue-total-spent">
                    <span class="loading-skeleton">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                </div>
                <div class="stat-label">–í—Å–µ–≥–æ –ø–æ—Ç—Ä–∞—á–µ–Ω–æ</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üíé</div>
                <div class="stat-number" id="revenue-net-profit">
                    <span class="loading-skeleton">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                </div>
                <div class="stat-label">–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å</div>
            </div>
        </div>

        <!-- –ì—Ä–∞—Ñ–∏–∫–∏ –¥–æ—Ö–æ–¥–æ–≤ –∏ —Ä–∞—Å—Ö–æ–¥–æ–≤ -->
        <div class="stats-grid">
            <div class="card animate-slide-in">
                <div class="card-header">
                    <h3 class="card-title">üìä –î–∏–Ω–∞–º–∏–∫–∞ –¥–æ—Ö–æ–¥–æ–≤</h3>
                    <p class="card-subtitle">–ó–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π</p>
                </div>
                <div class="card-body">
                    <div class="chart-container" style="height: 300px;">
                        <canvas id="revenueChart"></canvas>
                    </div>
                    <div id="revenue-chart-loading" class="loading-state">
                        <p>–ó–∞–≥—Ä—É–∑–∫–∞ –≥—Ä–∞—Ñ–∏–∫–∞ –¥–æ—Ö–æ–¥–æ–≤...</p>
                    </div>
                </div>
            </div>

            <div class="card animate-slide-in">
                <div class="card-header">
                    <h3 class="card-title">üìà –ü—Ä–æ–≥–Ω–æ–∑ –∑–∞—Ä–∞–±–æ—Ç–∫–∞</h3>
                    <p class="card-subtitle">–û—Ü–µ–Ω–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç—Ä–µ–Ω–¥–æ–≤</p>
                </div>
                <div class="card-body">
                    <div class="revenue-projection">
                        <div class="projection-item">
                            <span class="projection-label">–ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –º–µ—Å—è—Ü:</span>
                            <span class="projection-value" id="revenue-monthly-projection">
                                <span class="loading-skeleton">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                            </span>
                        </div>
                        <div class="projection-item">
                            <span class="projection-label">–°—Ä–µ–¥–Ω–∏–π –¥–æ—Ö–æ–¥ –≤ –¥–µ–Ω—å:</span>
                            <span class="projection-value" id="revenue-daily-average">
                                <span class="loading-skeleton">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                            </span>
                        </div>
                        <div class="projection-item">
                            <span class="projection-label">–¢—Ä–µ–Ω–¥:</span>
                            <span class="projection-value" id="revenue-trend">
                                <span class="loading-skeleton">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –î–æ—Ö–æ–¥—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º -->
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">üè∑Ô∏è –î–æ—Ö–æ–¥—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</h3>
                <p class="card-subtitle">–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞—Ä–∞–±–æ—Ç–∫–∞ –ø–æ —Ç–∏–ø–∞–º –æ—Ñ—Ñ–µ—Ä–æ–≤</p>
            </div>
            <div class="card-body">
                <div id="revenue-loading" class="loading-state">
                    <div class="loading-spinner"></div>
                    <p>–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö...</p>
                </div>
                <div id="revenue-error" class="error-state" style="display: none;">
                    <div class="error-icon">‚ùå</div>
                    <p>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</p>
                    <button onclick="loadRevenueData()" class="btn-retry">–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞</button>
                </div>
                <div id="revenue-content" style="display: none;">
                    <div class="category-revenue-list" id="revenue-categories">
                        <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                    </div>
                    <div id="revenue-empty" class="empty-state" style="display: none;">
                        <div class="stat-icon">üí∞</div>
                        <h3>–ù–µ—Ç —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</h3>
                        <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö —Ä–∞–∑–º–µ—â–µ–Ω–∏–π –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ -->
<script src="{{ url_for('static', filename='js/utils.js') }}"></script>
<script src="{{ url_for('static', filename='js/analytics.js') }}"></script>

<script>
// –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–∞–±–æ–≤
function switchTab(tabName) {
    // –£–¥–∞–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö —Ç–∞–±–æ–≤
    document.querySelectorAll('.tabs-nav a').forEach(tab => {
        tab.classList.remove('active');
    });
    
    // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ç–∞–±–æ–≤
    document.querySelectorAll('.tabs-content').forEach(content => {
        content.classList.remove('active');
    });
    
    // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –Ω—É–∂–Ω—ã–π —Ç–∞–±
    const activeTab = document.querySelector(`[data-tab="${tabName}"]`);
    const activeContent = document.getElementById(tabName);
    
    if (activeTab) activeTab.classList.add('active');
    if (activeContent) activeContent.classList.add('active');
}

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∏–∫–æ–≤ –ø–æ —Ç–∞–±–∞–º
document.addEventListener('DOMContentLoaded', function() {
    console.log('üìä –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');

    // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–∞–±–æ–≤
    document.querySelectorAll('.tabs-nav a').forEach(tab => {
        tab.addEventListener('click', function(e) {
            e.preventDefault();
            const tabName = this.getAttribute('data-tab');
            switchTab(tabName);
        });
    });

    // –î–∞–Ω–Ω—ã–µ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ analytics.js
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –≥—Ä–∞—Ñ–∏–∫–∏
    initializeCharts();
});

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥"
function goBack() {
    window.history.back();
}

// –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ - —Ç–µ–ø–µ—Ä—å –≤ analytics.js

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
function initializeCharts() {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –ª–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ Chart.js
    if (typeof Chart !== 'undefined') {
        // –ì—Ä–∞—Ñ–∏–∫ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
        const viewsCtx = document.getElementById('viewsChart');
        if (viewsCtx) {
            new Chart(viewsCtx, {
                type: 'line',
                data: {
                    labels: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10'],
                    datasets: [{
                        label: '–ü—Ä–æ—Å–º–æ—Ç—Ä—ã',
                        data: [1200, 1900, 3000, 5000, 2000, 3000, 4500, 6000, 7000, 8000],
                        borderColor: 'rgb(102, 126, 234)',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        // –ì—Ä–∞—Ñ–∏–∫ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
        const proposalsCtx = document.getElementById('proposalsChart');
        if (proposalsCtx) {
            new Chart(proposalsCtx, {
                type: 'doughnut',
                data: {
                    labels: ['–ü—Ä–∏–Ω—è—Ç–æ', '–û—Ç–∫–ª–æ–Ω–µ–Ω–æ', '–û–∂–∏–¥–∞–µ—Ç'],
                    datasets: [{
                        data: [65, 25, 10],
                        backgroundColor: [
                            'rgba(34, 197, 94, 0.8)',
                            'rgba(239, 68, 68, 0.8)',
                            'rgba(251, 191, 36, 0.8)'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        // –ì—Ä–∞—Ñ–∏–∫ —Ä–∞—Å—Ö–æ–¥–æ–≤
        const spendingCtx = document.getElementById('spendingChart');
        if (spendingCtx) {
            new Chart(spendingCtx, {
                type: 'bar',
                data: {
                    labels: ['–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç', '–ü—Ç', '–°–±', '–í—Å'],
                    datasets: [{
                        label: '–†–∞—Å—Ö–æ–¥—ã',
                        data: [3000, 4500, 2800, 6200, 5500, 4000, 3200],
                        backgroundColor: 'rgba(102, 126, 234, 0.8)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        // –ì—Ä–∞—Ñ–∏–∫ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
        const efficiencyCtx = document.getElementById('efficiencyChart');
        if (efficiencyCtx) {
            new Chart(efficiencyCtx, {
                type: 'radar',
                data: {
                    labels: ['CTR', '–ö–æ–Ω–≤–µ—Ä—Å–∏—è', 'ROI', '–û—Ö–≤–∞—Ç', '–í–æ–≤–ª–µ—á–µ–Ω–∏–µ'],
                    datasets: [{
                        label: '–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å',
                        data: [65, 59, 90, 81, 56],
                        borderColor: 'rgb(102, 126, 234)',
                        backgroundColor: 'rgba(102, 126, 234, 0.2)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }
    } else {
        console.error('Chart.js –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
    }
}
</script>
{% endblock %}