{% extends "base.html" %}

{% block title %}–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ñ—Ñ–µ—Ä–∞–º–∏ - Telegram Mini App{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/offers-specific.css') }}">
{% endblock %}

{% block content %}
<div class="container">
    <!-- Hero Section -->
    <div class="hero-section animate-fade-in">
        <button class="back-btn" onclick="goBack()">‚Üê –ù–∞–∑–∞–¥</button>
        <div class="hero-content">
            <span class="hero-icon">üéØ</span>
            <h1 class="hero-title">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ñ—Ñ–µ—Ä–∞–º–∏</h1>
            <p class="hero-subtitle">–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∏ –∏—â–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –æ—Ñ—Ñ–µ—Ä—ã</p>
        </div>
    </div>

    <!-- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–∞–±—ã -->
    <div class="tabs">
        <nav class="tabs-nav">
            <li><a href="#" class="active" data-tab="my-offers">–ú–æ–∏ –æ—Ñ—Ñ–µ—Ä—ã</a></li>
            <li><a href="#" data-tab="find-offer">–ù–∞–π—Ç–∏ –æ—Ñ—Ñ–µ—Ä</a></li>
            <li><a href="#" data-tab="create-offer">–°–æ–∑–¥–∞—Ç—å –æ—Ñ—Ñ–µ—Ä</a></li>
            <li><a href="#" data-tab="campaigns">–†–µ–∫–ª–∞–º–Ω–∞—è –∫–∞–º–ø–∞–Ω–∏—è</a></li>
            <li id="admin-tab" style="display: none;"><a href="#" data-tab="admin-moderation">‚öñÔ∏è –ú–æ–¥–µ—Ä–∞—Ü–∏—è</a></li>
        </nav>
    </div>

    <!-- Tab: –ú–æ–∏ –æ—Ñ—Ñ–µ—Ä—ã -->
    <div class="tabs-content active" id="my-offers">
        <div class="form-field">
            <div style="position: relative; max-width: 400px;">
                <span style="position: absolute; left: 16px; top: 50%; transform: translateY(-50%); color: var(--text-tertiary);">üîç</span>
                <input type="text" class="form-input" placeholder="–ü–æ–∏—Å–∫ –ø–æ –æ—Ñ—Ñ–µ—Ä–∞–º..." id="offersSearch" style="padding-left: 48px;">
            </div>
        </div>

        <div class="offers-container" id="offersGrid">
            <div class="empty-state" id="emptyOffersState">
                <div class="stat-icon">üìù</div>
                <h3>–ù–µ—Ç —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –æ—Ñ—Ñ–µ—Ä–æ–≤</h3>
                <p>–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–π –ø–µ—Ä–≤—ã–π –æ—Ñ—Ñ–µ—Ä –¥–ª—è –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –∫–∞–Ω–∞–ª–æ–≤</p>
                <button class="btn btn-primary" onclick="switchTab('create-offer')">
                    ‚ûï –°–æ–∑–¥–∞—Ç—å –æ—Ñ—Ñ–µ—Ä
                </button>
            </div>
        </div>
    </div>

    <!-- Tab: –ù–∞–π—Ç–∏ –æ—Ñ—Ñ–µ—Ä -->
    <div class="tabs-content" id="find-offer">
        <div class="form-field">
            <div style="position: relative; max-width: 400px;">
                <span style="position: absolute; left: 16px; top: 50%; transform: translateY(-50%); color: var(--text-tertiary);">üîç</span>
                <input type="text" class="form-input" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é, –∫–∞—Ç–µ–≥–æ—Ä–∏–∏..." id="findOffersSearch" style="padding-left: 48px;">
            </div>
        </div>

        <!-- –§–∏–ª—å—Ç—Ä—ã -->
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">üîß –§–∏–ª—å—Ç—Ä—ã</h3>
            </div>
            <div class="card-body">
                <div class="form-field">
                    <label class="form-label" for="findCategoryFilter">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                    <select class="form-select" id="findCategoryFilter">
                        <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                        <option value="tech">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</option>
                        <option value="finance">–§–∏–Ω–∞–Ω—Å—ã</option>
                        <option value="lifestyle">–°—Ç–∏–ª—å –∂–∏–∑–Ω–∏</option>
                        <option value="education">–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ</option>
                        <option value="business">–ë–∏–∑–Ω–µ—Å</option>
                        <option value="entertainment">–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</option>
                    </select>
                </div>

                <div class="form-field">
                    <label class="form-label" for="findBudgetMin">–ë—é–¥–∂–µ—Ç</label>
                    <div style="display: flex; gap: 8px;">
                        <input type="number" class="form-input" id="findBudgetMin" placeholder="–æ—Ç" min="0">
                        <input type="number" class="form-input" id="findBudgetMax" placeholder="–¥–æ" min="0">
                    </div>
                </div>

                <div class="form-field">
                    <label class="form-label" for="findMinSubscribers">–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø–æ–¥–ø–∏—Å—á–∏–∫–∏</label>
                    <input type="number" class="form-input" id="findMinSubscribers" placeholder="–ú–∏–Ω. –ø–æ–¥–ø–∏—Å—á–∏–∫–∏" min="0">
                </div>

                <div class="form-field">
                    <div style="display: flex; gap: var(--space-2);">
                        <button class="btn btn-primary" onclick="applyFindFilters()">üîç –ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
                        <button class="btn btn-secondary" onclick="clearFindFilters()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ -->
        <div id="findOffersGrid" class="offers-container">
            <!-- –î–æ—Å—Ç—É–ø–Ω—ã–µ –æ—Ñ—Ñ–µ—Ä—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
        </div>

        <!-- –ó–∞–≥—Ä—É–∑–∫–∞ -->
        <div id="findOffersLoading" class="empty-state" style="display: none;">
            <div class="stat-icon">‚è≥</div>
            <h3>–ü–æ–∏—Å–∫ –æ—Ñ—Ñ–µ—Ä–æ–≤...</h3>
        </div>
    </div>

    <!-- Tab: –°–æ–∑–¥–∞—Ç—å –æ—Ñ—Ñ–µ—Ä -->
    <div class="tabs-content" id="create-offer">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">üéØ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥–±–æ—Ä –∫–∞–Ω–∞–ª–æ–≤</h3>
                <button class="modal-close" style="background: none; border: none; font-size: 24px; cursor: pointer; color: var(--text-tertiary);">&times;</button>
            </div>
            <div class="card-body">
                <!-- –ü–æ—à–∞–≥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ -->
                <div style="margin-bottom: var(--space-6);">
                    <div style="display: flex; align-items: flex-start; gap: var(--space-3); margin-bottom: var(--space-4);">
                        <div style="background: var(--primary-100); border-radius: var(--radius-full); width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                            <span style="color: var(--primary-600); font-size: var(--text-lg);">üéØ</span>
                        </div>
                        <div>
                            <h4 style="margin: 0 0 var(--space-1) 0; font-size: var(--text-base); font-weight: 600; color: var(--text-primary);">1. –£–∫–∞–∂–∏—Ç–µ –±—é–¥–∂–µ—Ç –∫–∞–º–ø–∞–Ω–∏–∏ –∏ —Ç–µ–∫—Å—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏—è.</h4>
                            <p style="margin: 0; font-size: var(--text-sm); color: var(--text-secondary); line-height: var(--leading-normal);">
                                –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–µ–∫—Å—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏—è –∏–ª–∏ –∫–æ—Ä–æ—Ç–∫–æ –æ–ø–∏—à–∏—Ç–µ —Ç–æ, —á—Ç–æ –±—É–¥–µ—Ç–µ —Ä–µ–∫–ª–∞–º–∏—Ä–æ–≤–∞—Ç—å.
                            </p>
                            <p style="margin: var(--space-2) 0 0 0; font-size: var(--text-sm); color: var(--text-secondary); line-height: var(--leading-normal);">
                                –í—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ —É–∫–∞–∑–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ —Å–∞–π—Ç: –æ–Ω –±—É–¥–µ—Ç –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ü–µ–ª–µ–≤–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏.
                            </p>
                        </div>
                    </div>

                    <div style="display: flex; align-items: flex-start; gap: var(--space-3);">
                        <div style="background: var(--primary-100); border-radius: var(--radius-full); width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                            <span style="color: var(--primary-600); font-size: var(--text-lg);">üöÄ</span>
                        </div>
                        <div>
                            <h4 style="margin: 0 0 var(--space-1) 0; font-size: var(--text-base); font-weight: 600; color: var(--text-primary);">2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–æ–¥–±–æ—Ä.</h4>
                            <p style="margin: 0; font-size: var(--text-sm); color: var(--text-secondary); line-height: var(--leading-normal);">
                                –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤—ã —Å–º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º—ã—Ö –∫–∞–Ω–∞–ª–æ–≤, –¥–æ–±–∞–≤–∏—Ç—å –∏—Ö –≤ –∫–∞–º–ø–∞–Ω–∏—é –∏–ª–∏ –≤—ã–≥—Ä—É–∑–∏—Ç—å –º–µ–¥–∏–∞–ø–ª–∞–Ω.
                            </p>
                            <p style="margin: var(--space-2) 0 0 0; font-size: var(--text-sm); color: var(--text-secondary); line-height: var(--leading-normal);">
                                <strong>–ê–Ω–∞–ª–∏–∑ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –∏ –ø–æ–¥–±–æ—Ä –∫–∞–Ω–∞–ª–æ–≤ –æ–±—ã—á–Ω–æ –∑–∞–Ω–∏–º–∞–µ—Ç –æ–∫–æ–ª–æ 30 —Å–µ–∫—É–Ω–¥.</strong> –ó–∞ —ç—Ç–æ –≤—Ä–µ–º—è AI Gooroo Tools –∫–∞–∫ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ü–µ–ª–µ–≤—É—é –∞—É–¥–∏—Ç–æ—Ä–∏—é, —Ç–∞–∫ –∏ —É—á–∏—Ç—ã–≤–∞–µ—Ç –æ–ø—ã—Ç —É–∂–µ —Ä–∞–∑–º–µ—â–µ–Ω–Ω—ã—Ö —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- –§–æ—Ä–º–∞ -->
                <form id="autoOfferForm">
                    <div class="form-field">
                        <label class="form-label form-label-required" for="offerBudget">–ë—é–¥–∂–µ—Ç:</label>
                        <input type="number" class="form-input" id="offerBudget" name="budget" placeholder="20000" min="1000" required>
                        <div class="form-help" style="margin-top: var(--space-1); font-size: var(--text-xs); color: var(--text-tertiary);">
                            –£–∫–∞–∂–∏—Ç–µ –±—é–¥–∂–µ—Ç, –∫–æ—Ç–æ—Ä—ã–π –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –ø–æ—Ç—Ä–∞—Ç–∏—Ç—å –Ω–∞ –∫–∞–º–ø–∞–Ω–∏—é.
                            –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–±–µ—Ä–µ—Ç –∫–∞–Ω–∞–ª—ã –≤ —Ä–∞–º–∫–∞—Ö –±—é–¥–∂–µ—Ç–∞. –ï—Å–ª–∏ –∫–∞–∫–æ–π-—Ç–æ –∏–∑ –æ—Ç–æ–±—Ä–∞–Ω–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤ –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –±–æ–ª—å—à–µ —á–µ–º-—Ç–æ, –µ–≥–æ
                            –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–∫–ª—é—á–∏—Ç—å —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ.
                        </div>
                    </div>

                    <div class="form-field">
                        <label class="form-label form-label-required" for="offerDescription">–û–±—ä—è–≤–ª–µ–Ω–∏–µ:</label>
                        <textarea class="form-textarea" id="offerDescription" name="description" placeholder="üéì –†–∞—Å–ø—Ä–æ–¥–∞–∂–∞ –û–Ω–ª–∞–π–Ω-–ö—É—Ä—Å–æ–≤! üéì" rows="4" required></textarea>
                        <div style="margin-top: var(--space-2);">
                            <div style="border: 1px solid var(--border-subtle); border-radius: var(--radius-md); background: var(--bg-secondary);">
                                <div style="padding: var(--space-3); border-bottom: 1px solid var(--border-subtle); font-weight: 500; font-size: var(--text-sm); color: var(--text-primary);">
                                    üìö –£–Ω–∏–∫–∞–ª—å–Ω–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è! –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ–º –≤–∞–º –Ω–∞—à—É —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—É—é –∫–æ–ª–ª–µ–∫—Ü–∏—é –æ–Ω–ª–∞–π–Ω-–∫—É—Ä—Å–æ–≤ –ø–æ —Å–∞–º—ã–º —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–º —Ç–µ–º–∞–º ‚Äì –æ—Ç –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –¥–æ –∫—É–ª–∏–Ω–∞—Ä–∏–∏!
                                </div>
                                <div style="padding: var(--space-3); border-bottom: 1px solid var(--border-subtle); font-size: var(--text-sm); color: var(--text-secondary);">
                                    üöÄ –°–∫–∏–¥–∫–∞ –¥–æ 50%! –ù–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, –∏—â–µ—Ç–µ –ª–∏ –≤—ã –∫—É—Ä—Å –ø–æ —Å–∞–º–æ—Ä–∞–∑–≤–∏—Ç–∏—é, —Ö–æ—Ç–∏—Ç–µ –∏–∑—É—á–∏—Ç—å –Ω–æ–≤—ã–π —è–∑—ã–∫
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-field">
                        <button type="submit" class="btn btn-primary" style="width: 100%; background: var(--primary-500); border: none; padding: var(--space-3) var(--space-4); border-radius: var(--radius-md); color: white; font-weight: 500; cursor: pointer; transition: all var(--transition-fast);">
                            –ü–æ–¥–æ–±—Ä–∞—Ç—å –∫–∞–Ω–∞–ª—ã
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Tab: –ú–æ–¥–µ—Ä–∞—Ü–∏—è (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∞) -->
    <div class="tabs-content" id="admin-moderation" style="display: none;">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">‚öñÔ∏è –ú–æ–¥–µ—Ä–∞—Ü–∏—è –æ—Ñ—Ñ–µ—Ä–æ–≤</h3>
                <p class="card-subtitle">–û—Ñ—Ñ–µ—Ä—ã, –æ–∂–∏–¥–∞—é—â–∏–µ –º–æ–¥–µ—Ä–∞—Ü–∏–∏</p>
            </div>
            <div class="card-body">
                <div class="moderation-filters" style="margin-bottom: 20px;">
                    <div style="display: flex; gap: 12px; align-items: center; flex-wrap: wrap;">
                        <select id="moderationStatusFilter" class="form-select" style="min-width: 150px;">
                            <option value="pending">–ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏</option>
                            <option value="all">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                            <option value="approved">–û–¥–æ–±—Ä–µ–Ω–Ω—ã–µ</option>
                            <option value="rejected">–û—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã–µ</option>
                        </select>
                        <div style="position: relative;">
                            <span style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: var(--text-tertiary);">üîç</span>
                            <input type="text" class="form-input" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é..." id="moderationSearch" style="padding-left: 40px; min-width: 200px;">
                        </div>
                        <button class="btn btn-outline" onclick="refreshModeration()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
                    </div>
                </div>

                <div id="moderationGrid" class="offers-container">
                    <!-- –û—Ñ—Ñ–µ—Ä—ã –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
                </div>

                <div id="moderationLoading" class="loading-state" style="display: none;">
                    <div class="loading-spinner">‚è≥</div>
                    <p>–ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ñ—Ñ–µ—Ä–æ–≤ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏...</p>
                </div>

                <div id="moderationEmpty" class="empty-state" style="display: none;">
                    <div class="empty-icon">‚úÖ</div>
                    <h3>–ù–µ—Ç –æ—Ñ—Ñ–µ—Ä–æ–≤ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏</h3>
                    <p>–í—Å–µ –æ—Ñ—Ñ–µ—Ä—ã –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab: –†–µ–∫–ª–∞–º–Ω–∞—è –∫–∞–º–ø–∞–Ω–∏—è -->
    <div class="tabs-content" id="campaigns">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">üì¢ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏</h3>
                <p class="card-subtitle">–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é —Ä–µ–∫–ª–∞–º–Ω—É—é –∫–∞–º–ø–∞–Ω–∏—é</p>
            </div>
            <div class="card-body">
                <form id="campaignForm">
                    <!-- –ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏ -->
                    <div class="form-field">
                        <label class="form-label" for="campaignName">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
                        <input type="text" class="form-input" id="campaignName" name="name" placeholder="–ö—É—Ä—Å—ã –ø–æ –¥–∏–∑–∞–π–Ω—É" required>
                    </div>

                    <!-- –õ–∏–º–∏—Ç –±—é–¥–∂–µ—Ç–∞ -->
                    <div class="form-field">
                        <label class="form-label" for="campaignBudget">–õ–∏–º–∏—Ç</label>
                        <input type="number" class="form-input" id="campaignBudget" name="budget_limit" placeholder="–õ–∏–º–∏—Ç –±—é–¥–∂–µ—Ç–∞ –∫–∞–º–ø–∞–Ω–∏–∏ –≤ —Ä—É–±–ª—è—Ö" min="0" step="0.01" required>
                        <div class="form-help">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ —Ä–µ–∫–ª–∞–º—É, –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –∫–æ—Ç–æ—Ä–æ–π –∫–∞–º–ø–∞–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è. –õ–∏–º–∏—Ç —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ —Ä—É–±–ª—è—Ö.</div>
                    </div>

                    <!-- UTM-–º–µ—Ç–∫–∏ -->
                    <div class="form-field">
                        <label class="form-label">UTM-–º–µ—Ç–∫–∏</label>
                        <div style="display: flex; align-items: flex-start; gap: 12px;">
                            <input type="checkbox" id="campaignUtmTags" name="add_utm_tags" style="margin-top: 4px;">
                            <div>
                                <label for="campaignUtmTags" style="font-weight: 500; cursor: pointer;">–î–æ–±–∞–≤–ª—è—Ç—å UTM –º–µ—Ç–∫–∏ –∫ —Å—Å—ã–ª–∫–∞–º</label>
                                <div class="form-help" style="margin-top: 4px;">
                                    UTM-–º–µ—Ç–∫–∏ –ø–æ–º–æ–≥–∞—é—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ —Ç—Ä–∞—Ñ–∏–∫–∞.
                                    –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è UTM –º–µ—Ç–∫–∏ utm_source=telegram, utm_medium=channel, utm_campaign=[–∏–º—è –∫–∞–º–ø–∞–Ω–∏–∏], utm_term=[–Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞].
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- –¢—Ä–µ–∫–µ—Ä -->
                    <div class="form-field">
                        <label class="form-label">–¢—Ä–µ–∫–µ—Ä</label>
                        <div style="display: flex; align-items: flex-start; gap: 12px;">
                            <input type="checkbox" id="campaignTracker" name="track_clicks" style="margin-top: 4px;">
                            <div>
                                <label for="campaignTracker" style="font-weight: 500; cursor: pointer;">–û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∫–ª–∏–∫–∏ –ø–æ –∫–∞–∂–¥–æ–π —Å—Å—ã–ª–∫–µ</label>
                                <div class="form-help" style="margin-top: 4px;">
                                    –ü—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–ª–∏–∫–∞–º –∏–∑ –∫–∞–∂–¥–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏. 
                                    –î–∞–Ω–Ω—ã–µ –ø–æ –∫–ª–∏–∫–∞–º –¥–æ—Å—Ç—É–ø–Ω—ã –≤ —Ä–∞–∑–¥–µ–ª–µ "–ê–Ω–∞–ª–∏—Ç–∏–∫–∞". 
                                    –î–∞–Ω–Ω—ã–µ –≤ –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –Ω–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è –≤ —Å–≤—è–∑–∏ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏ Telegram.
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- –ü–µ—Ä–∏–æ–¥ —Ä–∞–±–æ—Ç—ã -->
                    <div class="form-field">
                        <label class="form-label">–ü–µ—Ä–∏–æ–¥ —Å</label>
                        <div style="display: flex; gap: 12px; align-items: center;">
                            <input type="date" class="form-input" id="campaignStartDate" name="start_date" required style="flex: 1;">
                            <span style="color: var(--text-secondary);">–ø–æ:</span>
                            <input type="date" class="form-input" id="campaignEndDate" name="end_date" required style="flex: 1;">
                        </div>
                        <div class="form-help">–ü—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –ø–µ—Ä–∏–æ–¥–æ–≤ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ —Ä–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª–µ–º —Ä–µ–∫–ª–∞–º—ã –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–µ –¥–∞—Ç—ã. (–ü—Ä–∏–º–µ–Ω–∏–º—ã–µ –¥–µ–π—Å—Ç–≤–∏–µ —Å–æ—Ü.—Å–µ—Ç–µ–π)</div>
                    </div>

                    <!-- –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã -->
                    <div class="form-field">
                        <label class="form-label">–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã</label>
                        <div style="display: flex; flex-direction: column; gap: 12px;">
                            <div style="display: flex; align-items: flex-start; gap: 12px;">
                                <input type="checkbox" id="campaignWeekends" name="work_weekends" style="margin-top: 4px;" checked>
                                <div>
                                    <label for="campaignWeekends" style="font-weight: 500; cursor: pointer;">–í—ã—Ö–æ–¥–Ω—ã–µ –¥–Ω–∏</label>
                                    <div class="form-help" style="margin-top: 4px;">
                                        –†–∞–∑–º–µ—â–µ–Ω–∏–µ —Ä–µ–∫–ª–∞–º—ã —Ç–æ–ª—å–∫–æ –≤ –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–Ω–∏ - —Ä–∞–∑–º–µ—â–∞—Ç—å –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Ç–æ–ª—å–∫–æ –≤ —Å—É–±–±–æ—Ç—É –∏ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ.
                                        –¢–æ–ª—å–∫–æ —Ä–∞–±–æ—á–∏–µ —á–∞—Å—ã - —Ä–∞–∑–º–µ—â–∞—Ç—å –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Ç–æ–ª—å–∫–æ –≤ –≤—Ä–µ–º—è —Å 9:00 –¥–æ 18:00.
                                    </div>
                                </div>
                            </div>
                            <div style="display: flex; align-items: flex-start; gap: 12px;">
                                <input type="checkbox" id="campaignWorkHours" name="work_hours_only" style="margin-top: 4px;">
                                <div>
                                    <label for="campaignWorkHours" style="font-weight: 500; cursor: pointer;">–¢–æ–ª—å–∫–æ —Ä–∞–±–æ—á–∏–µ —á–∞—Å—ã</label>
                                    <div class="form-help" style="margin-top: 4px;">
                                        –†–∞–∑–º–µ—â–µ–Ω–∏–µ —Ä–µ–∫–ª–∞–º—ã –≤ —Ç–µ—á–µ–Ω–∏–µ —Ä–∞–±–æ—á–∏—Ö —á–∞—Å–æ–≤ (9:00-18:00).
                                        –¢–æ–ª—å–∫–æ —Ä–∞–±–æ—á–∏–µ —á–∞—Å—ã - —Ä–∞–∑–º–µ—â–∞—Ç—å –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Ç–æ–ª—å–∫–æ –≤ –≤—Ä–µ–º—è —Å 9:00 –¥–æ 18:00.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- –†–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª—å -->
                    <div class="form-field">
                        <label class="form-label" for="campaignAdvertiser">–†–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª—å</label>
                        <select class="form-select" id="campaignAdvertiser" name="advertiser_type" required>
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø</option>
                            <option value="legal_entity">–Æ—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ –ª–∏—Ü–æ</option>
                            <option value="individual_entrepreneur">–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å</option>
                            <option value="physical_person">–§–∏–∑–∏—á–µ—Å–∫–æ–µ –ª–∏—Ü–æ</option>
                        </select>
                        <div class="form-help">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —Ä–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏ –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º.</div>
                    </div>

                    <!-- –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ -->
                    <div class="form-field">
                        <label class="form-label" for="campaignProductName">–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ</label>
                        <input type="text" class="form-input" id="campaignProductName" name="product_name" placeholder="–û–û–û &quot;–≠—Å –∫–∞–∫ –¥–µ–ª–∞—Ç—å&quot;" required>
                        <div class="form-help">
                            –ï—Å–ª–∏ –≤—ã —Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ –ª–∏—Ü–æ, —è —Ä–µ–∫–æ–º–µ–Ω–¥—É—é —á—Ç–æ –≤—ã –ù–¢ —É—á–∞—Å—Ç–Ω–∏–∫–∏ —Ä—ã–Ω–∫–∞.
                            –ü—Ä–∏—à–ª–∏—Ç–µ –≤–∞—à –ò–ü, —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –§GMO –ù—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω –≤ —Ç–æ–º —á–∏—Å–ª–µ.
                        </div>
                    </div>

                    <!-- –ò–ù–ù -->
                    <div class="form-field">
                        <label class="form-label" for="campaignInn">–ò–ù–ù</label>
                        <input type="text" class="form-input" id="campaignInn" name="advertiser_inn" placeholder="–ò–ù–ù —Ä–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª—è" pattern="[0-9]{10,12}">
                        <div class="form-help">
                            –£–∫–∞–∂–∏—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ò–ù–ù –µ—Å–ª–∏ –≤—ã —Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ –ª–∏—Ü–æ, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–º —è–≤–ª—è–µ—Ç—Å—è —Ç–æ, —á—Ç–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –ò–ù–ù.
                            –ï—Å–ª–∏ –≤—ã –Ω–µ –∑–Ω–∞–µ—Ç–µ –Ω–æ–º–µ—Ä –ò–ù–ù, —É–∑–Ω–∞—Ç—å –µ–≥–æ –º–æ–∂–Ω–æ —Å –ò–ü –∏–ª–∏ –û–û–û —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–∏—Å –Ω–∞ —Å–∞–π—Ç–µ nalog.ru
                        </div>
                    </div>

                    <!-- –†–µ–∫–ª–∞–º–Ω—ã–π –ø–æ—Å—Ç -->
                    <div class="form-field">
                        <label class="form-label" for="campaignAdContent">–†–µ–∫–ª–∞–º–Ω—ã–π –ø–æ—Å—Ç</label>
                        <textarea class="form-input" id="campaignAdContent" name="ad_content" rows="8" placeholder="–í–≤–µ–¥–∏ –∏–ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Ä–µ–∫–ª–∞–º–Ω–æ–≥–æ –ø–æ—Å—Ç" required></textarea>
                        <div class="form-help">
                            1. –î–æ–±–∞–≤—å—Ç–µ –≤ —ç—Ç–æ—Ç –±–ª–æ–∫ —Ç–µ–∫—Å—Ç–æ–≤–∞—è —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π –∏ –∏–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ –¥–ª—è –∏—Ö —Ä–∞–∑–º–µ—â–µ–Ω–∏—è.
                            
                            2. –î–æ–±–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ —Å–∞–π—Ç –∫ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –∏ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å –≤–Ω–µ–¥—Ä—è–µ–º—ã–µ —Ä–µ—Å—É—Ä—Å.
                            
                            3. –î–æ–±–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –ø—Ä–∏–º–µ–Ω—è–µ–º—ã–µ —Ä–µ–∞–∫—Ç–∏–≤–Ω—ã–º–∏ —Å–ø–æ—Å–æ–± —Å–æ–≤—ã –≤–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –¥–ª—è –ø–æ–∑–∏—Ü–∏–∏ —Ä–∞—Ü–∏–∏ –≤–∫–ª—é—á–∞–ª–æ—Å—å –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å.
                            
                            4. –î–æ–±–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ —Å–∞–π—Ç –∏ –∞–∫—Ç–∏–≤–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. –ö–∞–Ω–∞–ª—ã –æ–±—ã—á–Ω–∞—è –∫–∞—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å—Å—ã–ª–∫–∏ –æ –≤–∞—à–∫–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤–∫–ª—é—á–∏—Ç—å –≤ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ –∏–ª–∏ –≤–º–µ—Å—Ç–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏.
                        </div>
                    </div>

                    <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
                    <div class="form-field" style="display: flex; gap: 12px; justify-content: space-between; margin-top: 24px;">
                        <button type="button" class="btn btn-outline" onclick="saveCampaignDraft()" style="flex: 0 0 auto;">
                            –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ —á–µ—Ä–Ω–æ–≤–∏–∫
                        </button>
                        <button type="submit" class="btn btn-primary" style="flex: 1; min-width: 200px;">
                            –°–æ–∑–¥–∞—Ç—å –∫–∞–º–ø–∞–Ω–∏—é
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<!-- –ù–æ–≤–∞—è –º–æ–¥—É–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ -->
<script type="module" src="{{ url_for('static', filename='js/offers/offers-main.js') }}"></script>
<!-- Fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤ -->
<script nomodule src="{{ url_for('static', filename='js/offers.js.backup') }}"></script>

<script>
// –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∫–æ–¥ –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
// –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ç–µ–ø–µ—Ä—å –≤ –º–æ–¥—É–ª—è—Ö offers/

document.addEventListener('DOMContentLoaded', function() {
    console.log('üéØ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –æ—Ñ—Ñ–µ—Ä–æ–≤ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)');
    
    // –í—Ä–µ–º–µ–Ω–Ω—ã–π —Ç–µ—Å—Ç —Å—Ç–∏–ª–µ–π –∫–æ–º–ø–∞–∫—Ç–Ω—ã—Ö –∫–∞—Ä—Ç–æ—á–µ–∫
    setTimeout(() => {
        const testButton = document.createElement('button');
        testButton.innerHTML = '–¢–µ—Å—Ç –∫–æ–º–ø–∞–∫—Ç–Ω—ã—Ö –∫–∞—Ä—Ç–æ—á–µ–∫';
        testButton.style.cssText = 'position: fixed; top: 10px; right: 10px; z-index: 9999; padding: 8px; background: red; color: white; border: none; border-radius: 4px; cursor: pointer;';
        testButton.onclick = () => {
            testCompactChannelCards();
        };
        document.body.appendChild(testButton);
    }, 1000);
});

// –§—É–Ω–∫—Ü–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–º–ø–∞–∫—Ç–Ω—ã—Ö –∫–∞—Ä—Ç–æ—á–µ–∫
function testCompactChannelCards() {
    console.log('üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–∫—Ç–Ω—ã—Ö –∫–∞—Ä—Ç–æ—á–µ–∫');
    
    const testData = [
        {
            id: 'test1',
            title: '–í–ª–∞–¥–∏–º–∏—Ä –ì–æ—Ä–±–æ–≤—Å–∫–∏–π',
            description: '–ê–≤—Ç–æ—Ä—Å–∫–∏–π –∫–∞–Ω–∞–ª –í–ª–∞–¥–∏–º–∏—Ä–∞ –ì–æ—Ä–±–æ–≤—Å–∫–æ–≥–æ. –ü—Ä–∏—Å—ã–ª–∞—Ç—å –Ω–æ–≤–æ—Å—Ç—å @gorbovsk –ü–æ –≤–æ–ø—Ä–æ—Å–∞–º —Ä–µ–∫–ª–∞–º—ã @KlimentTG –†–µ—Å—É—Ä—Å –≤–∫–ª—é—á—ë–Ω –≤ –ø–µ—Ä–µ—á–µ–Ω—å...',
            username: '@werwfvsd',
            subscriber_count: 27500,
            engagement_rate: 32,
            avg_views: 8800,
            ads_count_7d: 0,
            price_per_post: 3500,
            price_per_24h: 7137
        }
    ];
    
    // –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å —Ç–æ–π –∂–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π, —á—Ç–æ –∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –∫–æ–¥–µ
    const modalHtml = `
        <div class="modal-overlay modal-large active" id="test-modal" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.6); display: flex; align-items: center; justify-content: center; z-index: 10000;">
            <div class="modal-content" style="background: white; border-radius: 12px; padding: 20px; max-width: 900px; max-height: 90vh; overflow: hidden;">
                <div class="modal-header">
                    <h3 class="modal-title">üì∫ –¢–µ—Å—Ç –∫–æ–º–ø–∞–∫—Ç–Ω—ã—Ö –∫–∞—Ä—Ç–æ—á–µ–∫</h3>
                </div>
                <div class="modal-body" style="overflow-y: auto; max-height: calc(90vh - 120px);">
                    <div class="channel-selection">
                        <div class="channel-selection-header">
                            <p>–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞–Ω–∞–ª—ã –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –æ—Ñ—Ñ–µ—Ä–∞: <strong>–¢–µ—Å—Ç–æ–≤—ã–π –æ—Ñ—Ñ–µ—Ä</strong></p>
                            <div class="channel-selection-stats">
                                <span id="test-selected-count">0</span> –∫–∞–Ω–∞–ª–æ–≤ –≤—ã–±—Ä–∞–Ω–æ
                            </div>
                        </div>
                        
                        <div class="channel-filters">
                            <select id="test-channel-sort">
                                <option value="subscribers">–ü–æ –ø–æ–¥–ø–∏—Å—á–∏–∫–∞–º</option>
                                <option value="price">–ü–æ —Ü–µ–Ω–µ</option>
                                <option value="engagement">–ü–æ –≤–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç–∏</option>
                            </select>
                        </div>
                        
                        <div class="channels-grid" id="test-channels-grid">
                            ${testData.map((channel, index) => createTestChannelCard(channel, index + 1)).join('')}
                        </div>
                        
                        <div class="channel-selection-actions" style="margin-top: 16px; display: flex; gap: 10px; flex-wrap: wrap;">
                            <button onclick="document.getElementById('test-modal').remove()" style="padding: 8px 16px; background: #6c757d; color: white; border: none; border-radius: 6px; cursor: pointer; flex: 1; min-width: 120px;">–ó–∞–∫—Ä—ã—Ç—å</button>
                            <button style="padding: 8px 16px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer; flex: 2; min-width: 150px;">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `;
    
    document.body.insertAdjacentHTML('beforeend', modalHtml);
}

// –¢–µ—Å—Ç–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ä—Ç–æ—á–∫–∏
function createTestChannelCard(channel, number) {
    const price = channel.price_per_post || 0;
    // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ü–µ–Ω—ã –∑–∞ 24—á
    const price24h = channel.price_per_24h || price;
    const views = channel.avg_views || Math.round(channel.subscriber_count * 0.3);
    
    return `
        <div class="channel-card-compact" data-channel-id="${channel.id}">
            <div class="channel-header">
                <div class="channel-number">${number}.</div>
                <div class="channel-info">
                    <h4 class="channel-title">${channel.title}</h4>
                    <p class="channel-description">${channel.description.substring(0, 60)}...</p>
                    <span class="channel-username">${channel.username}</span>
                </div>
            </div>

            <div class="channel-stats">
                <div class="stats-grid">
                    <!-- –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞: –ü–æ–¥–ø–∏—Å—á–∏–∫–∏ + –í–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç—å -->
                    <div class="stat-item">
                        <span class="stat-label">–ü–æ–¥–ø–∏—Å—á–∏–∫–∏</span>
                        <span class="stat-value">üë• ${new Intl.NumberFormat('ru-RU').format(channel.subscriber_count)}</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">–í–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç—å (ER)</span>
                        <span class="stat-value">üìä ${channel.engagement_rate}%</span>
                    </div>
                    <!-- –í—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞: –ü—Ä–æ—Å–º–æ—Ç—Ä—ã + –†–µ–∫–ª–∞–º–∞ -->
                    <div class="stat-item">
                        <span class="stat-label">–ü—Ä–æ—Å–º–æ—Ç—Ä—ã</span>
                        <span class="stat-value">üëÅ ${new Intl.NumberFormat('ru-RU').format(views)}</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">–†–µ–∫–ª–∞–º–∞ –∑–∞ 7 –¥–Ω–µ–π</span>
                        <span class="stat-value">üì¢ ${channel.ads_count_7d}</span>
                    </div>
                </div>
            </div>

            <div class="channel-pricing">
                <div class="price-item">
                    <span class="price-label">–¶–µ–Ω–∞ –∑–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä:</span>
                    <span class="price-value">${(price / views * 1000).toFixed(2)}–†</span>
                </div>
                <div class="price-item">
                    <span class="price-label">–¶–µ–Ω–∞ –∑–∞ 24—á:</span>
                    <span class="price-value">${new Intl.NumberFormat('ru-RU').format(price24h)}–†</span>
                </div>
            </div>

            <div class="channel-actions">
                <button type="button" class="btn-details" onclick="toggleDetails('${channel.id}')">
                    –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                </button>
                <button type="button" class="btn-add" onclick="toggleSelection('${channel.id}', this)">
                    –î–æ–±–∞–≤–∏—Ç—å
                </button>
            </div>

            <div class="channel-details" id="details-${channel.id}" style="display: none;">
                <div class="demographics">
                    <h5>–ì–µ–Ω–¥–µ—Ä</h5>
                    <div class="gender-stats">
                        <span>–ú:65%</span>
                        <span>–ñ:35%</span>
                    </div>
                </div>
                <div class="age-groups">
                    <h5>–í–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ –≥—Ä—É–ø–ø—ã</h5>
                    <div class="age-stats">
                        <span>18-24: 5%</span>
                        <span>25-30: 20%</span>
                        <span>35-30: 25%</span>
                        <span>45-25: 25%</span>
                        <span>55-15: 15%</span>
                        <span>65-5: 5%</span>
                    </div>
                </div>
            </div>
        </div>
    `;
}

// –¢–µ—Å—Ç–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
function toggleDetails(channelId) {
    const details = document.getElementById(`details-${channelId}`);
    const button = event.target;
    
    if (details.style.display === 'none' || !details.style.display) {
        details.style.display = 'block';
        button.textContent = '–°–∫—Ä—ã—Ç—å';
        button.classList.add('active');
    } else {
        details.style.display = 'none';
        button.textContent = '–ü–æ–¥—Ä–æ–±–Ω–µ–µ';
        button.classList.remove('active');
    }
}

function toggleSelection(channelId, button) {
    const card = button.closest('.channel-card-compact');
    
    if (card.classList.contains('selected')) {
        card.classList.remove('selected');
        button.textContent = '–î–æ–±–∞–≤–∏—Ç—å';
        button.classList.remove('selected');
    } else {
        card.classList.add('selected');
        button.textContent = '‚úì –î–æ–±–∞–≤–ª–µ–Ω';
        button.classList.add('selected');
    }
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫
    const selectedCount = document.querySelectorAll('.channel-card-compact.selected').length;
    const counter = document.getElementById('test-selected-count');
    if (counter) counter.textContent = selectedCount;
}

// –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∫–∞–º–ø–∞–Ω–∏–π —Ç–µ–ø–µ—Ä—å –≤ –º–æ–¥—É–ª—è—Ö offers/
// –ó–¥–µ—Å—å —Ç–æ–ª—å–∫–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

// –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏
function refreshModeration() {
    if (window.offersManager && window.offersManager.loadModerationOffers) {
        window.offersManager.loadModerationOffers();
    } else {
        console.warn('‚ö†Ô∏è OffersManager –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –º–µ—Ç–æ–¥ loadModerationOffers –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
    }
}
</script>
{% endblock %}